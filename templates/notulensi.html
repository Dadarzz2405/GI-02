{% extends "base.html" %}
{% block title %}Notulensi — Rohis{% endblock %}

{% block content %}
<div class="card shadow p-4">
    <h3 class="fw-bold mb-3">
        Notulensi — {{ session.name }}
    </h3>

    <div id="editor" style="height:400px">
        {{ note.content|safe if note else "" }}
    </div>

    <button id="saveBtn" class="btn btn-success mt-3">
        Save
    </button>
</div>

<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

<script>
const quill = new Quill('#editor', {
    theme: 'snow',
    modules: {
        toolbar: [
            ['bold', 'italic', 'underline'],
            [{ 'header': [1, 2, false] }],
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            ['clean']
        ]
    }
});

document.getElementById("saveBtn").onclick = async () => {
    const content = quill.root.innerHTML;

    const res = await fetch(
        "/api/notulensi/{{ session.id }}",
        {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ content })
        }
    );

    if (res.ok) alert("Saved");
};
</script>
{% endblock %}
